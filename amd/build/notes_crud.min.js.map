{"version":3,"file":"notes_crud.min.js","sources":["../src/notes_crud.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * report_adv_config monitors cohort concurrency and limits access based on restrictions.\n *\n * @copyright 2023 Jon Deavers jondeavers@gmail.com\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport ModalForm from 'core_form/modalform';\nimport Log from 'core/log';\nimport Config from 'core/config';\nimport {get_string as getString} from 'core/str';\n\nexport const initForm = (linkSelector, formClass) => {\n    let buttons = document.querySelectorAll(linkSelector);\n\n    buttons.forEach((button) => {\n        button.addEventListener('click', (e) => {\n            e.preventDefault();\n\n            Log.debug(`Buttons: ${button.dataset.id}`);\n            let configId = button.dataset.id;\n\n            Log.debug(`Config ID: ${configId}`);\n            const form = new ModalForm({\n                formClass,\n                args: configId ? {configid: configId} : {},\n                modalConfig: {title: configId ?\n                        getString('editnotes', 'report_adv_configlog') : getString('createnotes', 'report_adv_config')},\n                returnFocus: e.currentTarget\n            });\n            // If necessary extend functionality by overriding class methods, for example:\n            form.addEventListener(form.events.FORM_SUBMITTED, (e) => {\n                const response = e.detail;\n                Log.debug('Form submitted...');\n                let redirect = `${Config.wwwroot}/report/adv_configlog/index.php?`;\n                let first = false;\n                for (let key in response) {\n                    if (first) {\n                        first = false;\n                    } else {\n                        redirect = redirect + '&';\n                    }\n                    redirect = redirect + `${key}=${response[key]}`;\n                }\n                window.location.assign(redirect);\n            });\n\n            // Demo of different events.\n            form.addEventListener(form.events.LOADED, () => {\n                Log.debug('Modal form loaded');\n            });\n            form.addEventListener(form.events.NOSUBMIT_BUTTON_PRESSED,\n                () => Log.debug('No submit button pressed'));\n            form.addEventListener(form.events.CLIENT_VALIDATION_ERROR, () => Log.debug('Client-side validation error'));\n            form.addEventListener(form.events.SERVER_VALIDATION_ERROR, () => Log.debug('Server-side validation error'));\n            form.addEventListener(form.events.ERROR, (e) => Log.debug('Oopsie - ' + e.detail.message));\n            form.addEventListener(form.events.SUBMIT_BUTTON_PRESSED, () => Log.debug('Submit button pressed'));\n            form.addEventListener(form.events.CANCEL_BUTTON_PRESSED, () => Log.debug('Cancel button pressed'));\n\n            form.show();\n        });\n    });\n};"],"names":["linkSelector","formClass","document","querySelectorAll","forEach","button","addEventListener","e","preventDefault","debug","dataset","id","configId","form","ModalForm","args","configid","modalConfig","title","returnFocus","currentTarget","events","FORM_SUBMITTED","response","detail","redirect","Config","wwwroot","first","key","window","location","assign","LOADED","NOSUBMIT_BUTTON_PRESSED","Log","CLIENT_VALIDATION_ERROR","SERVER_VALIDATION_ERROR","ERROR","message","SUBMIT_BUTTON_PRESSED","CANCEL_BUTTON_PRESSED","show"],"mappings":";;;;;;gOA0BwB,CAACA,aAAcC,aACrBC,SAASC,iBAAiBH,cAEhCI,SAASC,SACbA,OAAOC,iBAAiB,SAAUC,IAC9BA,EAAEC,8BAEEC,yBAAkBJ,OAAOK,QAAQC,SACjCC,SAAWP,OAAOK,QAAQC,gBAE1BF,2BAAoBG,iBAClBC,KAAO,IAAIC,mBAAU,CACvBb,UAAAA,UACAc,KAAMH,SAAW,CAACI,SAAUJ,UAAY,GACxCK,YAAa,CAACC,MAAON,UACb,mBAAU,YAAa,yBAA0B,mBAAU,cAAe,sBAClFO,YAAaZ,EAAEa,gBAGnBP,KAAKP,iBAAiBO,KAAKQ,OAAOC,gBAAiBf,UACzCgB,SAAWhB,EAAEiB,oBACff,MAAM,yBACNgB,mBAAcC,gBAAOC,4CACrBC,OAAQ,MACP,IAAIC,OAAON,SACRK,MACAA,OAAQ,EAERH,UAAsB,IAE1BA,oBAAyBI,gBAAON,SAASM,MAE7CC,OAAOC,SAASC,OAAOP,aAI3BZ,KAAKP,iBAAiBO,KAAKQ,OAAOY,QAAQ,kBAClCxB,MAAM,wBAEdI,KAAKP,iBAAiBO,KAAKQ,OAAOa,yBAC9B,IAAMC,aAAI1B,MAAM,8BACpBI,KAAKP,iBAAiBO,KAAKQ,OAAOe,yBAAyB,IAAMD,aAAI1B,MAAM,kCAC3EI,KAAKP,iBAAiBO,KAAKQ,OAAOgB,yBAAyB,IAAMF,aAAI1B,MAAM,kCAC3EI,KAAKP,iBAAiBO,KAAKQ,OAAOiB,OAAQ/B,GAAM4B,aAAI1B,MAAM,YAAcF,EAAEiB,OAAOe,WACjF1B,KAAKP,iBAAiBO,KAAKQ,OAAOmB,uBAAuB,IAAML,aAAI1B,MAAM,2BACzEI,KAAKP,iBAAiBO,KAAKQ,OAAOoB,uBAAuB,IAAMN,aAAI1B,MAAM,2BAEzEI,KAAK6B"}