{"version":3,"file":"notes_crud.min.js","sources":["../src/notes_crud.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * report_adv_config monitors cohort concurrency and limits access based on restrictions.\n *\n * @ report_adv_configlog\n * @copyright 2023 Jon Deavers jondeavers@gmail.com\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport ModalForm from 'core_form/modalform';\nimport Log from 'core/log';\nimport Config from 'core/config';\nimport {get_string as getString} from 'core/str';\n\nexport const initForm = (linkSelector, formClass) => {\n    let buttons = document.querySelectorAll(linkSelector);\n\n    window.console.log(buttons);\n\n    buttons.forEach((button) => {\n        button.addEventListener('click', (e) => {\n            e.preventDefault();\n            let limitId = button.dataset.id;\n            Log.debug(`Limit ID: ${limitId}`);\n            const form = new ModalForm({\n                formClass,\n                args: limitId ? {limitid: limitId} : {},\n                modalConfig: {title: limitId ?\n                        getString('editnotes', 'report_adv_configlog') : getString('createnotes', 'report_adv_config')},\n                returnFocus: e.currentTarget\n            });\n            // If necessary extend functionality by overriding class methods, for example:\n            form.addEventListener(form.events.FORM_SUBMITTED, (e) => {\n                const response = e.detail;\n                Log.debug('Form submitted...');\n                let redirect = `${Config.wwwroot}/report/adv_configlog/index.php?`;\n                let first = false;\n                for (let key in response) {\n                    if (first) {\n                        first = false;\n                    } else {\n                        redirect = redirect + '&';\n                    }\n                    redirect = redirect + `${key}=${response[key]}`;\n                }\n                window.location.assign(redirect);\n            });\n\n            // Demo of different events.\n            form.addEventListener(form.events.LOADED, () => {\n                Log.debug('Modal form loaded');\n            });\n            form.addEventListener(form.events.NOSUBMIT_BUTTON_PRESSED,\n                () => Log.debug('No submit button pressed'));\n            form.addEventListener(form.events.CLIENT_VALIDATION_ERROR, () => Log.debug('Client-side validation error'));\n            form.addEventListener(form.events.SERVER_VALIDATION_ERROR, () => Log.debug('Server-side validation error'));\n            form.addEventListener(form.events.ERROR, (e) => Log.debug('Oopsie - ' + e.detail.message));\n            form.addEventListener(form.events.SUBMIT_BUTTON_PRESSED, () => Log.debug('Submit button pressed'));\n            form.addEventListener(form.events.CANCEL_BUTTON_PRESSED, () => Log.debug('Cancel button pressed'));\n\n            form.show();\n        });\n    });\n};"],"names":["linkSelector","formClass","buttons","document","querySelectorAll","window","console","log","forEach","button","addEventListener","e","preventDefault","limitId","dataset","id","debug","form","ModalForm","args","limitid","modalConfig","title","returnFocus","currentTarget","events","FORM_SUBMITTED","response","detail","redirect","Config","wwwroot","first","key","location","assign","LOADED","NOSUBMIT_BUTTON_PRESSED","Log","CLIENT_VALIDATION_ERROR","SERVER_VALIDATION_ERROR","ERROR","message","SUBMIT_BUTTON_PRESSED","CANCEL_BUTTON_PRESSED","show"],"mappings":";;;;;;;gOA2BwB,CAACA,aAAcC,iBAC/BC,QAAUC,SAASC,iBAAiBJ,cAExCK,OAAOC,QAAQC,IAAIL,SAEnBA,QAAQM,SAASC,SACbA,OAAOC,iBAAiB,SAAUC,IAC9BA,EAAEC,qBACEC,QAAUJ,OAAOK,QAAQC,gBACzBC,0BAAmBH,gBACjBI,KAAO,IAAIC,mBAAU,CACvBjB,UAAAA,UACAkB,KAAMN,QAAU,CAACO,QAASP,SAAW,GACrCQ,YAAa,CAACC,MAAOT,SACb,mBAAU,YAAa,yBAA0B,mBAAU,cAAe,sBAClFU,YAAaZ,EAAEa,gBAGnBP,KAAKP,iBAAiBO,KAAKQ,OAAOC,gBAAiBf,UACzCgB,SAAWhB,EAAEiB,oBACfZ,MAAM,yBACNa,mBAAcC,gBAAOC,4CACrBC,OAAQ,MACP,IAAIC,OAAON,SACRK,MACAA,OAAQ,EAERH,UAAsB,IAE1BA,oBAAyBI,gBAAON,SAASM,MAE7C5B,OAAO6B,SAASC,OAAON,aAI3BZ,KAAKP,iBAAiBO,KAAKQ,OAAOW,QAAQ,kBAClCpB,MAAM,wBAEdC,KAAKP,iBAAiBO,KAAKQ,OAAOY,yBAC9B,IAAMC,aAAItB,MAAM,8BACpBC,KAAKP,iBAAiBO,KAAKQ,OAAOc,yBAAyB,IAAMD,aAAItB,MAAM,kCAC3EC,KAAKP,iBAAiBO,KAAKQ,OAAOe,yBAAyB,IAAMF,aAAItB,MAAM,kCAC3EC,KAAKP,iBAAiBO,KAAKQ,OAAOgB,OAAQ9B,GAAM2B,aAAItB,MAAM,YAAcL,EAAEiB,OAAOc,WACjFzB,KAAKP,iBAAiBO,KAAKQ,OAAOkB,uBAAuB,IAAML,aAAItB,MAAM,2BACzEC,KAAKP,iBAAiBO,KAAKQ,OAAOmB,uBAAuB,IAAMN,aAAItB,MAAM,2BAEzEC,KAAK4B"}